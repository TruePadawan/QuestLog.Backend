import{r as s,a as D,j as e,N as T,t as o}from"./index-BM71IHYH.js";import{u as B,a as F}from"./useAuth-BrmHBAwv.js";import{L as b}from"./Loader-xl498cTG.js";import{u as H}from"./useQuery-Bo-X5PFM.js";import{g as I}from"./quest.api-JQDOGfAe.js";import{A as V,g as K,a as X}from"./utils-Dhn_WXxr.js";import{F as U}from"./FormInputField-Xka4Ls7u.js";import{B as m}from"./Button-DjVsqX09.js";import{L as W}from"./logo-BIfEBSO-.js";import{t as h}from"./IconoirContext-DnFuTd40.js";import{x as Z}from"./Xmark-DvtNZVn5.js";import{x as G}from"./CheckCircle-dwEPAdtQ.js";import"./auth.api-BD3ZayB1.js";var Y=Object.defineProperty,C=Object.getOwnPropertySymbols,z=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable,E=(r,t,a)=>t in r?Y(r,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):r[t]=a,x=(r,t)=>{for(var a in t||(t={}))z.call(t,a)&&E(r,a,t[a]);if(C)for(var a of C(t))J.call(t,a)&&E(r,a,t[a]);return r};const _=(r,t)=>{const a=s.useContext(h),i=x(x({},a),r);return s.createElement("svg",x({width:"1.5em",height:"1.5em",viewBox:"0 0 24 24",strokeWidth:1.5,fill:"none",xmlns:"http://www.w3.org/2000/svg",color:"currentColor",ref:t},i),s.createElement("path",{d:"M21 12L3 12M3 12L11.5 3.5M3 12L11.5 20.5",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}))},q=s.forwardRef(_);var ee=q,re=Object.defineProperty,k=Object.getOwnPropertySymbols,te=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable,L=(r,t,a)=>t in r?re(r,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):r[t]=a,f=(r,t)=>{for(var a in t||(t={}))te.call(t,a)&&L(r,a,t[a]);if(k)for(var a of k(t))ae.call(t,a)&&L(r,a,t[a]);return r};const se=(r,t)=>{const a=s.useContext(h),i=f(f({},a),r);return s.createElement("svg",f({width:"1.5em",height:"1.5em",viewBox:"0 0 24 24",strokeWidth:1.5,fill:"none",xmlns:"http://www.w3.org/2000/svg",color:"currentColor",ref:t},i),s.createElement("path",{d:"M14.3632 5.65156L15.8431 4.17157C16.6242 3.39052 17.8905 3.39052 18.6716 4.17157L20.0858 5.58579C20.8668 6.36683 20.8668 7.63316 20.0858 8.41421L18.6058 9.8942M14.3632 5.65156L4.74749 15.2672C4.41542 15.5993 4.21079 16.0376 4.16947 16.5054L3.92738 19.2459C3.87261 19.8659 4.39148 20.3848 5.0115 20.33L7.75191 20.0879C8.21972 20.0466 8.65806 19.8419 8.99013 19.5099L18.6058 9.8942M14.3632 5.65156L18.6058 9.8942",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}))},ne=s.forwardRef(se);var ie=ne,ce=Object.defineProperty,O=Object.getOwnPropertySymbols,le=Object.prototype.hasOwnProperty,oe=Object.prototype.propertyIsEnumerable,S=(r,t,a)=>t in r?ce(r,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):r[t]=a,u=(r,t)=>{for(var a in t||(t={}))le.call(t,a)&&S(r,a,t[a]);if(O)for(var a of O(t))oe.call(t,a)&&S(r,a,t[a]);return r};const me=(r,t)=>{const a=s.useContext(h),i=u(u({},a),r);return s.createElement("svg",u({width:"1.5em",height:"1.5em",strokeWidth:1.5,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",color:"currentColor",ref:t},i),s.createElement("path",{d:"M3 19V5C3 3.89543 3.89543 3 5 3H16.1716C16.702 3 17.2107 3.21071 17.5858 3.58579L20.4142 6.41421C20.7893 6.78929 21 7.29799 21 7.82843V19C21 20.1046 20.1046 21 19 21H5C3.89543 21 3 20.1046 3 19Z",stroke:"currentColor"}),s.createElement("path",{d:"M8.6 9H15.4C15.7314 9 16 8.73137 16 8.4V3.6C16 3.26863 15.7314 3 15.4 3H8.6C8.26863 3 8 3.26863 8 3.6V8.4C8 8.73137 8.26863 9 8.6 9Z",stroke:"currentColor"}),s.createElement("path",{d:"M6 13.6V21H18V13.6C18 13.2686 17.7314 13 17.4 13H6.6C6.26863 13 6 13.2686 6 13.6Z",stroke:"currentColor"}))},de=s.forwardRef(me);var pe=de;function xe(r){switch(r){case"MainQuest":return"Main Quest";case"SideQuest":return"Side Quest";case"Tutorial":return"Tutorial";default:return r}}function fe(r){return new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}function ue(r){switch(r){case"Low":return"#13EC5B";case"Medium":return"#f59e0b";case"High":return"#ef4444";default:return"#c9cdd3"}}function Ae(){const{user:r,isLoadingAuthState:t,isAuthenticated:a,logOut:i}=B(),R=D(),[A,l]=s.useState(!1),[g,d]=s.useState(""),[y,j]=s.useState(!1),{data:$,isLoading:M}=H({queryKey:["quests","completed"],queryFn:()=>I({completed:!0}),enabled:a});if(t)return e.jsx("div",{className:"flex justify-center items-center min-h-screen",children:e.jsx(b,{})});if(!a)return e.jsx(T,{to:"/auth/login",replace:!0});const w=$?.sort((n,c)=>{const p=n.completedAt?new Date(n.completedAt).getTime():new Date(n.deadline).getTime();return(c.completedAt?new Date(c.completedAt).getTime():new Date(c.deadline).getTime())-p}).slice(0,10)??[];function P(){d(r?.characterName??""),l(!0)}function v(){l(!1),d("")}async function N(){const n=g.trim();if(!n){o.error("Name cannot be empty");return}if(n===r?.characterName){l(!1);return}j(!0);try{await F({characterName:n}),await R.invalidateQueries({queryKey:["auth"]}),o.success("Name updated successfully"),l(!1)}catch(c){if(c instanceof V){const p=K(c);o.error(p?.data?.message??"Failed to update name")}else o.error("Failed to update name")}finally{j(!1)}}const Q=r?.xp??0;return e.jsxs("div",{className:"flex flex-col min-h-screen",children:[e.jsxs("header",{className:"flex items-center justify-between px-4 py-3 sm:px-6 lg:px-8 border-b-4 border-border-primary bg-bg-primary gap-x-2",children:[e.jsxs("a",{className:"flex gap-x-2 sm:gap-x-3 items-center shrink-0",href:"/",children:[e.jsx("img",{className:"h-6 w-6 sm:h-7 sm:w-7 lg:h-8 lg:w-8",src:W,alt:"logo"}),e.jsx("span",{className:"text-white font-primary text-lg sm:text-2xl lg:text-3xl leading-none",children:"QUESTLOG"})]}),e.jsxs(m,{variant:"clean",href:"/dashboard",className:"flex items-center gap-x-1.5 sm:gap-x-2 text-xs sm:text-sm font-secondary whitespace-nowrap shrink-0",children:[e.jsx(ee,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Back to Quests"}),e.jsx("span",{className:"sm:hidden",children:"Back"})]})]}),e.jsx("div",{className:"flex-1 p-4 sm:p-8 lg:p-12 max-w-4xl mx-auto w-full",children:e.jsxs("div",{className:"flex flex-col gap-y-10",children:[e.jsxs("div",{className:"border-2 border-border-primary",children:[e.jsx("div",{className:"px-6 py-4 border-b-2 border-border-primary",children:e.jsx("span",{className:"font-primary text-xs text-accent-amber tracking-widest",children:"ADVENTURER PROFILE"})}),e.jsxs("div",{className:"p-6 sm:p-8 bg-bg-secondary flex flex-col gap-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-y-2",children:[e.jsx("span",{className:"font-primary text-[0.625rem] text-primary-green tracking-widest uppercase",children:"Name"}),A?e.jsxs("div",{className:"flex items-center gap-x-3",children:[e.jsx(U,{value:g,onChange:n=>d(n.target.value),onKeyDown:n=>{n.key==="Enter"&&N(),n.key==="Escape"&&v()},placeholder:"Enter new name",className:"text-sm",autoFocus:!0}),e.jsxs(m,{variant:"filled",onClick:N,disabled:y,className:"px-3 py-2 flex items-center gap-x-2 whitespace-nowrap shrink-0",children:[e.jsx(pe,{className:"w-4 h-4"}),y?"Saving...":"Save"]}),e.jsx(m,{variant:"outline",onClick:v,color:"red",className:"px-3 py-2 flex items-center shrink-0",children:e.jsx(Z,{className:"w-4 h-4"})})]}):e.jsxs("div",{className:"flex items-center gap-x-3",children:[e.jsx("span",{className:"text-white font-secondary text-lg",children:r?.characterName}),e.jsx("button",{onClick:P,className:"text-gray-500 hover:text-primary-green transition-colors",title:"Edit name",children:e.jsx(ie,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"flex flex-col gap-y-2",children:[e.jsx("span",{className:"font-primary text-[0.625rem] text-primary-green tracking-widest uppercase",children:"Class"}),e.jsx("span",{className:"text-white font-secondary",children:r?.characterClass})]}),e.jsxs("div",{className:"flex flex-col gap-y-2",children:[e.jsx("span",{className:"font-primary text-[0.625rem] text-primary-green tracking-widest uppercase",children:"Tier"}),e.jsx("span",{className:"text-red-400 font-secondary font-bold",children:r?.tier})]}),e.jsxs("div",{className:"flex flex-col gap-y-2",children:[e.jsx("span",{className:"font-primary text-[0.625rem] text-primary-green tracking-widest uppercase",children:"Experience"}),e.jsxs("span",{className:"text-accent-amber font-secondary font-bold",children:[Q.toLocaleString()," XP"]})]})]})]})]}),e.jsxs("div",{className:"border-2 border-border-primary",children:[e.jsx("div",{className:"px-6 py-4 border-b-2 border-border-primary",children:e.jsx("span",{className:"font-primary text-xs text-accent-amber tracking-widest",children:"RECENTLY COMPLETED"})}),e.jsx("div",{className:"bg-bg-secondary",children:M?e.jsx("div",{className:"flex justify-center items-center p-12",children:e.jsx(b,{})}):w.length>0?e.jsx("div",{className:"divide-y-2 divide-border-primary",children:w.map(n=>e.jsx(he,{quest:n},n.id))}):e.jsx("p",{className:"text-gray-500 font-secondary text-center py-12 text-sm",children:"No completed quests yet. Keep adventuring!"})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(m,{variant:"outline",color:"red",onClick:()=>i(),className:"px-6 py-3",children:"Log Out"})})]})})]})}function he({quest:r}){const t=X(r.difficultyRating);return e.jsxs("a",{href:`/dashboard/quest/${r.id}`,className:"flex items-start gap-x-3 px-4 py-3 sm:px-6 sm:py-4 hover:bg-bg-primary/50 transition-colors cursor-pointer",children:[e.jsx(G,{className:"w-5 h-5 text-primary-green shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex flex-col gap-y-2 flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-x-3",children:[e.jsx("span",{className:"text-white font-secondary font-bold text-sm truncate",children:r.title}),e.jsxs("span",{className:"text-primary-green font-secondary font-bold text-xs whitespace-nowrap px-2 py-0.5 bg-primary-green/15 border border-primary-green/30 shrink-0",children:["+",t," XP"]})]}),e.jsxs("div",{className:"flex items-center flex-wrap gap-x-2 gap-y-1 text-[0.625rem] font-primary text-gray-500",children:[r.completedAt&&e.jsx("span",{children:fe(r.completedAt)}),e.jsx("span",{className:"text-gray-600",children:"·"}),e.jsx("span",{children:xe(r.category)}),e.jsx("span",{className:"text-gray-600",children:"·"}),e.jsx("span",{style:{color:ue(r.difficultyRating)},children:r.difficultyRating}),r.tags.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-600",children:"·"}),e.jsx("span",{className:"text-accent-cyan",children:r.tags.map(a=>`#${a}`).join(" ")})]})]})]})]})}export{Ae as component};
