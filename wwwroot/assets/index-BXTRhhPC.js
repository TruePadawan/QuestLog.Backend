import{r as a,b as X,a as Y,j as e,t as d,Z as B}from"./index-BM71IHYH.js";import{u as P,i as V,E as Z}from"./index-XGZyWgJn.js";import{S as _,O as x}from"./Select-C4e6SRbX.js";import{R as J,F as m,a as p,b as u,c as g,d as h,e as f,w as K,D as $,f as ee,g as se,h as te,i as ae,j as le,k as ie}from"./field-eIo_uTst.js";import{x as re}from"./Xmark-DvtNZVn5.js";import{B as r}from"./Button-DjVsqX09.js";import{F as A}from"./FormInputField-Xka4Ls7u.js";import{a as C,A as ne,g as oe}from"./utils-Dhn_WXxr.js";import{c as ce}from"./quest.api-JQDOGfAe.js";import"./IconoirContext-DnFuTd40.js";function Ne(){const[q,j]=a.useState(!0),[i,y]=a.useState([]),[N,v]=a.useState(""),[Q,b]=a.useState(!1),[E,R]=a.useState("Low"),[F,I]=a.useState(C("Low")),[D,U]=a.useState("MainQuest"),[T,G]=a.useState(""),[L,w]=a.useState(!1),S=a.useRef(null),O=X(),M=Y();async function k(){const s=S.current?.value??null;if(s===null)return d("No deadline selected");const t=new Date(s),o=n?.isEmpty?null:n.getJSON();w(!0);try{const l={title:T,details:o,difficultyRating:E,category:D,deadline:t,tags:i};console.log(l),await ce(l),M.invalidateQueries({queryKey:["quests"]}),await O({to:"/dashboard/main-quest"})}catch(l){if(l instanceof ne){const c=oe(l);d(c?.data.message,{position:"bottom-left"})}else l instanceof B&&(console.log(l),l.issues.forEach(c=>d(c.message,{position:"bottom-left"})))}finally{w(!1)}}const z=s=>{s.preventDefault();const t=N.trim().toUpperCase(),o=!i.includes(t);t!=""&&o&&(y([...i,t]),v(""),b(!1))},H=s=>{y(i.filter(t=>t!==s))},W=s=>{const t=s.target.value;R(t),I(C(t))},n=P({extensions:[V],content:null,editorProps:{attributes:{spellcheck:"true"}},onCreate:({editor:s})=>j(s.isEmpty),onUpdate:({editor:s})=>j(s.isEmpty)});return e.jsxs("div",{className:"p-4 grid grid-cols-1 gap-6 lg:grid-cols-[minmax(0,1fr)_400px] font-primary",children:[e.jsx("div",{className:"flex flex-col gap-y-6",children:e.jsxs("div",{className:"grow flex flex-col",children:[e.jsx("span",{className:"text-white font-bold font-primary text-xl px-4 py-3",children:"NEW QUEST ENTRY"}),e.jsxs("div",{className:"grow p-4 flex flex-col gap-y-6",children:[e.jsx(A,{label:"QUEST TITLE",type:"text",placeholder:"Slay the deadline dragon",name:"questTitle",value:T,onChange:s=>G(s.target.value),labelClassName:"text-white"}),e.jsxs("div",{className:"flex flex-col gap-y-3",children:[e.jsx("legend",{className:"text-white text-xs",children:"QUEST CATEGORY"}),e.jsxs(J,{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",value:D,onValueChange:s=>U(s),children:[e.jsx(m,{htmlFor:"quest-category-main",children:e.jsxs(p,{orientation:"horizontal",children:[e.jsxs(u,{children:[e.jsx(g,{className:"text-sm font-primary",children:"Main Quest"}),e.jsx(h,{className:"text-xs font-secondary",children:"Story-critical arc"})]}),e.jsx(f,{value:"MainQuest",id:"quest-category-main"})]})}),e.jsx(m,{htmlFor:"quest-category-side",children:e.jsxs(p,{orientation:"horizontal",children:[e.jsxs(u,{children:[e.jsx(g,{className:"text-sm font-primary",children:"Side Quest"}),e.jsx(h,{className:"text-xs font-secondary",children:"Optional loot"})]}),e.jsx(f,{value:"SideQuest",id:"quest-category-side"})]})}),e.jsx(m,{htmlFor:"quest-category-tutorial",children:e.jsxs(p,{orientation:"horizontal",children:[e.jsxs(u,{children:[e.jsx(g,{className:"text-sm font-primary",children:"Tutorials"}),e.jsx(h,{className:"text-xs font-secondary",children:"Learn the ropes"})]}),e.jsx(f,{value:"Tutorial",id:"quest-category-tutorial"})]})})]})]}),e.jsxs("div",{className:"grow flex flex-col gap-y-2",children:[e.jsx("span",{className:"text-white text-xs tracking-[0.2em]",children:"QUEST DETAILS"}),e.jsxs("div",{className:"grow quest-editor-shell",children:[q&&e.jsx("span",{className:"quest-editor-placeholder",children:"Document objectives, steps, and rewards for the quest."}),e.jsx(Z,{editor:n,className:"quest-editor","aria-label":"Quest details editor"})]})]})]})]})}),e.jsxs("div",{className:"lg:border-l lg:border-border-primary md:p-6 flex flex-col gap-y-8",children:[e.jsx("span",{className:"text-white font-bold font-primary text-xl",children:"QUEST DATA"}),e.jsxs("div",{className:"flex flex-col gap-y-6 bg-[#000000]/30 p-4",children:[e.jsxs("div",{className:"flex flex-col items-stretch gap-y-2 font-primary text-xs",children:[e.jsx("label",{htmlFor:"difficulty-rating",className:"text-primary-green/70",children:"DIFFICULTY RATING"}),e.jsxs(_,{id:"difficulty-rating",value:E,onChange:W,children:[e.jsx(x,{value:"Low",children:"LOW"}),e.jsx(x,{value:"Medium",children:"MEDIUM"}),e.jsx(x,{value:"High",children:"HIGH"})]})]}),e.jsx("hr",{className:"bg-primary-green/60 h-0.5"}),e.jsxs("div",{className:"flex flex-col gap-y-2",children:[e.jsx("span",{className:"text-primary-green/70 text-xs",children:"EST. REWARD"}),e.jsxs("div",{className:"flex items-center gap-x-2",children:[e.jsx(K,{className:"text-primary-green"}),e.jsxs("span",{className:"text-primary-green font-bold",children:[F," XP"]})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-y-2",children:[e.jsxs("div",{className:"flex justify-between text-primary-green",children:[e.jsx("span",{className:"text-white",children:"TAGS"}),e.jsxs($,{open:Q,onOpenChange:b,children:[e.jsx(ee,{asChild:!0,children:e.jsx(r,{variant:"clean",className:"p-0",children:"+ ADD TAG"})}),e.jsxs(se,{children:[e.jsxs(te,{children:[e.jsx(ae,{children:"ADD NEW TAG"}),e.jsx(le,{children:"Enter a tag to categorize your quest."})]}),e.jsxs("form",{onSubmit:z,className:"flex flex-col gap-y-4 py-4",children:[e.jsx("div",{className:"flex flex-col gap-y-2",children:e.jsx(A,{id:"tag-name",label:"TAG NAME",labelClassName:"text-white text-xs",value:N,onChange:s=>v(s.target.value),placeholder:"URGENT, DAILY, etc.",autoFocus:!0})}),e.jsx(ie,{children:e.jsx(r,{type:"submit",variant:"filled",children:"CONFIRM TAG"})})]})]})]})]}),e.jsx("ul",{className:"flex flex-wrap gap-2 list-none font-secondary text-primary-green",children:i.map(s=>e.jsxs("li",{className:"font-semibold py-1 px-2 border border-border-primary flex items-center gap-x-2 bg-bg-secondary/30",children:[e.jsx("span",{className:"text-xs",children:s}),e.jsx(r,{variant:"clean",className:"p-0 text-primary-green hover:text-white transition-colors",onClick:()=>H(s),children:e.jsx(re,{className:"size-4"})})]},s))})]}),e.jsxs("div",{className:"flex flex-col gap-y-2",children:[e.jsx("span",{className:"text-white",children:"DEADLINE"}),e.jsx("input",{type:"datetime-local",className:"bg-bg-primary text-primary-green border border-border-primary p-2",ref:S,defaultValue:new Date().toISOString().slice(0,16).replace("T"," ")})]}),e.jsx(r,{type:"button",variant:"filled",className:"mt-auto",disabled:L,onClick:k,children:"ADD QUEST"})]})]})}export{Ne as component};
